# 概述



# InputManager::start

```c++
status_t InputManager::start() {
    // 启动InputDispatcher的事件分发
    status_t result = mDispatcher->start();
    if (result) {
        ALOGE("Could not start InputDispatcher thread due to error %d.", result);
        return result;
    }
    // 启动InputReader
    result = mReader->start();
    if (result) {
        ALOGE("Could not start InputReader due to error %d.", result);

        mDispatcher->stop();
        return result;
    }

    return OK;
}
```



# InputDispatcher::start

```c++
status_t InputDispatcher::start() {
    if (mThread) {
        return ALREADY_EXISTS;
    }
    // 启动一个InputDispatcher线程
    mThread = std::make_unique<InputThread>(
            "InputDispatcher", [this]() { dispatchOnce(); }, [this]() { mLooper->wake(); });
    return OK;
}
```

# InputReader::start

```c++
/**
 * 代码位于：framework/native/services/inputflinger/reader/InputReader.cpp
 **/
status_t InputReader::start() {
    if (mThread) {
        return ALREADY_EXISTS;
    }
    // 启动一个InputReader线程
    mThread = std::make_unique<InputThread>(
            "InputReader", [this]() { loopOnce(); }, [this]() { mEventHub->wake(); });
    return OK;
}
```

InputManager的start方法的主要功能是启动两个线程:

- 启动线程“InputReader”
- 启动线程”InputDispatcher“

