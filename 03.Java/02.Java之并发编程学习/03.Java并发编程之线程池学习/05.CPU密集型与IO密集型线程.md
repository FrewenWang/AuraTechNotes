---
title: CPU密集型与IO密集型线程
date: 2022-01-05 00:00:00
updated: 2022-01-05 00:00:00
tags: [Java,多线程,并发编程]
type: [Java,多线程,并发编程]
comments: CPU密集型与IO密集型线程
description: CPU密集型与IO密集型线程
keywords: CPU密集型与IO密集型线程
top_img:
mathjax:
katex:
aside:
aplayer:
highlight_shrink:
---

[TOC]

# 概述



# CPU密集型（CPU-bound）

CPU密集型也叫计算密集型，程序运行绝大部分的时间都进行CPU的运算，CPU的负载率非常高。 例如一个计算圆周率至小数点一千位以下的程序，在执行的过程当中绝大部份时间用在三角函数和开根号的计算，便是属于CPU密集型的程序。

CPU-bound的程序一般而言CPU占用率相当高。这可能是因为任务本身不太需要访问I/O设备，也可能是因为程序是多线程实现因此屏蔽掉了等待I/O的时间。所以，针对CPU密集型的程序，我们为了更好的压榨CPU的计算力。又因为CPU密集型的程序里面IO读取比较少。理论上我们可以设计如下：


```shell
cpu密集型（CPU-bound）线程池设计最佳线程数=cpu核数或者cpu核数±1
```


# IO密集型（I/O bound）

IO密集型指的是系统的CPU性能相对硬盘、内存要好很多，此时，系统运作，大部分的状况是CPU在等I/O (硬盘/内存) 的读/写操作，此时CPU Loading并不高。


  I/O bound的程序一般在达到性能极限时，CPU占用率仍然较低。这可能是因为任务本身需要大量I/O操作，而pipeline做得不是很好，没有充分利用处理器能力。比如接收一个前端请求--解析参数--查询数据库--返回给前端这样的，那么就是IO密集型的，例如web应用。

```shell
I/O密集型（I/O-bound）线程池设计  最佳线程数 = ((线程等待时间+线程cpu时间)/线程cpu时间*cpu数目)
```


# CPU密集型与IO密集型比较

我们可以把任务分为计算密集型和IO密集型。

计算密集型任务的特点是要进行大量的计算，消耗CPU资源，比如计算圆周率、对视频进行高清解码等等，全靠CPU的运算能力。这种计算密集型任务虽然也可以用多任务完成，但是任务越多，花在任务切换的时间就越多，CPU执行任务的效率就越低，所以，要最高效地利用CPU，计算密集型任务同时进行的数量应当等于CPU的核心数。

计算密集型任务由于主要消耗CPU资源，因此，代码运行效率至关重要。Python这样的脚本语言运行效率很低，完全不适合计算密集型任务。对于计算密集型任务，最好用C语言编写。

第二种任务的类型是IO密集型，涉及到网络、磁盘IO的任务都是IO密集型任务，这类任务的特点是CPU消耗很少，任务的大部分时间都在等待IO操作完成（因为IO的速度远远低于CPU和内存的速度）。对于IO密集型任务，任务越多，CPU效率越高，但也有一个限度。常见的大部分任务都是IO密集型任务，比如Web应用。

 IO密集型任务执行期间，99%的时间都花在IO上，花在CPU上的时间很少，因此，用运行速度极快的C语言替换用Python这样运行速度极低的脚本语言，完全无法提升运行效率。对于IO密集型任务，最合适的语言就是开发效率最高（代码量最少）的语言，脚本语言是首选，C语言最差。


 计算密集型程序适合C语言多线程，I/O密集型适合脚本语言开发的多线程。

 